\chapter{Introduction}

The selection of a good oil recovery method requires a lot of effort, as there are many parameters that influence the resulting output \cite{doi:10.1137/1.9780898717075}. To achieve a greater profit, one often wants to find control parameters that optimize a net present value (NPV) function which evaluates the economic value of the chosen oil recovery strategy. A difficulty here is that the computation of a NPV function is usually expensive due to the complex reservoir simulation models. A popular algorithm for the maximization of the NPV function is the ensemble-based (EnOpt) optimization method \cite{articleChen}, which uses samples around each iterate to compute an approximation of a preconditioned gradient at that iterate. With this gradient, the next iterate is computed by a gradient ascent method. An extension of the EnOpt method is the so-called adaptive EnOpt algorithm. Here, the covariance matrix, that is used for the sampling around the iterates, is adjusted with respect to the result from the previous iteration \cite{Stordal2016-cj}.

In \cite{Keil2022-dj}, a modification of the adaptive EnOpt method is proposed which is called the adaptive machine learning EnOpt (Adaptive-ML-EnOpt) algorithm. In this procedure, a neural network-based surrogate is trained in each iteration to reduce costly calls of the full order model NPV function and thus speed up the computation. This method is applied to an enhanced oil recovery strategy \cite{ABIDIN201211} where a polymer-water mixture is injected into the reservoir to bring the oil to the surface.

In this thesis, we apply the adaptive EnOpt and the Adaptive-ML-EnOpt algorithms to a specific optimal control problem that is constrained by parabolic equations. We show that the Adaptive-ML-EnOpt algorithm performs better on this control problem than the adaptive EnOpt method. However, there are other, non-ensemble-based optimizers, that are better suited for this problem, which we also demonstrate. The source code can be found at [https://github.com/AndyWert/master-thesis]. Further instructions to run this code are specified in the file `README.md'.

The constrained control problem, along with the solution strategy of the corresponding discretized parabolic equations, is presented in Chapter \ref{capterParabolicOptimalControlProblems}. After that, Chapter \ref{ChapterEnsembleBasedOptimizationAlgorithm} presents the adaptive EnOpt algorithm. In Chapter \ref{ChapterAdaptiveMLEnOptAlgorithm} the Adaptive-ML-EnOpt procedure, similar to the one from \cite{Keil2022-dj}, is described. Finally, we test and compare these two algorithms in Chapter \ref{chapterNumericalExperiments}.